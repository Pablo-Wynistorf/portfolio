<!-- Analytics Tracker -->
<style>
  .visitor-counter-wrapper {
    text-align: center;
    padding: 20px 0;
    margin-top: 20px;
    border-top: 1px solid var(--card-separator-color, #e0e0e0);
  }
  
  .visitor-counter-text {
    font-size: 1.2em;
    font-weight: 600;
    color: var(--card-text-color-main, #333);
  }
  
  @media (prefers-color-scheme: dark) {
    .visitor-counter-text {
      color: var(--card-text-color-main, #e0e0e0);
    }
  }
</style>

<div class="visitor-counter-wrapper">
    <div class="visitor-counter-text">
        <span id="visitor-count">Loading visitor count...</span>
    </div>
</div>

<script>
  (function () {
    const url = "https://count.onedns.ch";
    
    async function send() {
      try {
        const res = await fetch(url, {
          method: "POST",
          mode: "cors",
          credentials: "omit"
        });
        return await res.json();
      } catch {
        return null;
      }
    }
    
    window.AnalyticsTracker = {
      count: 0,
      async refresh() {
        const data = await send();
        if (data && typeof data.count === "number") {
          this.count = data.count;
        }
        return this.count;
      }
    };
    
    // Auto-run and update display
    window.AnalyticsTracker.refresh().then(count => {
      const element = document.getElementById("visitor-count");
      if (element && count > 0) {
        element.textContent = `üëÅÔ∏è Visitors: ${count.toLocaleString()}`;
      } else if (element) {
        element.textContent = "Visitor count unavailable";
      }
    });
  })();
</script>
